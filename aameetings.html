<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Weekend AA Meetings</title>
    <meta name="description" content="Meetings of AA in Manhattan on Weekends by Special Interests">
    <meta name="author" content="Zui Chen">
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.3.4/dist/leaflet.css"
  integrity="sha512-puBpdR0798OZvTTbP4A8Ix/l+A4dHDD0DGqYW6RQ+9jxkRFclaxxQb/SJAWZfWAkuyeQUytO7+7N4QKrDh+drA=="
  crossorigin=""/>
  <script src="https://unpkg.com/leaflet@1.3.4/dist/leaflet.js"
  integrity="sha512-nMMmRyTVoLYqjP9hrbed9S+FzjZHW5gY1TWCHA5ckwXZBadntCNs8kEqAWdrb9O7rxbCaA4lKTIWjDXZxflOcA=="
  crossorigin=""></script>
    <script type="text/javascript" src="build/dat.gui.js"></script>
    <!-- <script type="text/javascript" src="js/sketch.js"></script> -->
  </head>
  <body>
    <div id="mapid">
      <script type="text/javascript">
        var data = [{"mtspin":"Agnostic","schedule":[{"day":"Saturday","time":"5:00 PM"},{"day":"Sunday","time":"5:30 PM"},{"day":"Sunday","time":"4:00 PM"}],"location":[{"lat":40.7879892,"long":-73.9707609,"address":"595 COLUMBUS AVE New York NY "},{"lat":40.7381228,"long":-74.0010304,"address":"208 W 13TH ST New York, NY"},{"lat":40.7381228,"long":-74.0010304,"address":"208 W 13TH ST New York, NY"}],"num_obs":"2"},{"mtspin":"As Bill Sees It","schedule":[{"day":"Sunday","time":"7:00 PM"},{"day":"Saturday","time":"6:00 AM"},{"day":"Sunday","time":"6:00 AM"},{"day":"Sunday","time":"4:00 PM"},{"day":"Saturday","time":"10:00 PM"},{"day":"Saturday","time":"10:00 AM"}],"location":[{"lat":40.7309636,"long":-73.9880637,"address":"206-208 E 11TH ST New York, NY"},{"lat":40.7945161,"long":-73.9710419,"address":"207 W 96TH ST New York NY "},{"lat":40.7945161,"long":-73.9710419,"address":"207 W 96TH ST New York NY "},{"lat":40.7721222,"long":-73.9517608,"address":"413 E 79TH STATE ROAD NY ST New York NY "},{"lat":40.7945161,"long":-73.9710419,"address":"207 W 96TH ST New York NY "},{"lat":40.7774259,"long":-73.9812051,"address":"152 W 71ST ST New York NY "}],"num_obs":"4"},{"mtspin":"Beginners Workshop","schedule":[{"day":"Sunday","time":"9:15 PM"}],"location":[{"lat":40.7575385,"long":-73.9901368,"address":"303 W 42ND ST New York NY "}],"num_obs":"1"},{"mtspin":"Big Book Workshop","schedule":[{"day":"Saturday","time":"9:30 AM"}],"location":[{"lat":40.8232166,"long":-73.9484769,"address":"469 W 142ND ST New York NY "}],"num_obs":"1"},{"mtspin":"Children Welcome","schedule":[{"day":"Saturday","time":"5:00 PM"},{"day":"Saturday","time":"10:00 AM"},{"day":"Sunday","time":"1:00 PM"},{"day":"Sunday","time":"5:00 PM"}],"location":[{"lat":40.7912379,"long":-73.9655109,"address":"3 W 95TH ST New York NY "},{"lat":40.7721222,"long":-73.9517608,"address":"413 E 79TH STATE ROAD NY ST New York NY "},{"lat":40.7354854,"long":-74.0031569,"address":"50 PERRY ST New York NY "},{"lat":40.7912379,"long":-73.9655109,"address":"3 W 95TH ST New York NY "}],"num_obs":"3"},{"mtspin":"Eleventh Step","schedule":[{"day":"Sunday","time":"11:00 AM"},{"day":"Sunday","time":"12:45 PM"},{"day":"Saturday","time":"12:00 AM"}],"location":[{"lat":40.7332068,"long":-73.9946888,"address":"7 E 10TH STRERT New York NY "},{"lat":40.7431787,"long":-73.9952777,"address":"155 W 22ND ST New York, NY"},{"lat":40.7575385,"long":-73.9901368,"address":"303 W 42ND ST New York NY "}],"num_obs":"3"},{"mtspin":"Eleventh Step Meditation","schedule":[{"day":"Saturday","time":"7:30 PM"}],"location":[{"lat":40.7483929,"long":-73.9787906,"address":"122 E 37TH ST New York, NY"}],"num_obs":"1"},{"mtspin":"First Step Workshop","schedule":[{"day":"Sunday","time":"12:45 PM"},{"day":"Saturday","time":"3:15 PM"},{"day":"Sunday","time":"12:45 PM"},{"day":"Saturday","time":"10:30 AM"}],"location":[{"lat":40.7483929,"long":-73.9787906,"address":"122 E 37TH ST New York, NY"},{"lat":40.7790604,"long":-73.9588788,"address":"48 E 84TH STATE ROAD NY ST New York NY "},{"lat":40.7483929,"long":-73.9787906,"address":"122 E 37TH ST New York, NY"},{"lat":40.7708644,"long":-73.9806413,"address":"5 W 63RD ST New York NY "}],"num_obs":"3"},{"mtspin":"Fourth Step Workshop","schedule":[{"day":"Sunday","time":"3:00 PM"}],"location":[{"lat":40.729824,"long":-73.982816,"address":"411 E 12TH ST New York, NY"}],"num_obs":"1"},{"mtspin":"Gay, Lesbian and Bisexual","schedule":[{"day":"Sunday","time":"7:00 PM"},{"day":"Sunday","time":"7:30 PM"},{"day":"Sunday","time":"8:30 PM"},{"day":"Saturday","time":"6:00 PM"},{"day":"Saturday","time":"5:30 PM"},{"day":"Sunday","time":"5:30 PM"},{"day":"Saturday","time":"6:45 PM"},{"day":"Sunday","time":"6:45 PM"},{"day":"Saturday","time":"8:00 PM"},{"day":"Sunday","time":"8:00 PM"},{"day":"Saturday","time":"6:00 PM"},{"day":"Sunday","time":"8:00 PM"},{"day":"Sunday","time":"12:30 PM"},{"day":"Sunday","time":"6:45 PM"}],"location":[{"lat":40.7360657,"long":-74.0019452,"address":"224 WAVERLY PL New York NY "},{"lat":40.8664723,"long":-73.9264521,"address":"20 CUMMING ST New York NY "},{"lat":40.7360657,"long":-74.0019452,"address":"224 WAVERLY PL New York NY "},{"lat":40.6701581,"long":-73.9819879,"address":"371 6TH AVE New York NY "},{"lat":40.7593831,"long":-73.9872329,"address":"252 W 46TH ST New York NY "},{"lat":40.7593831,"long":-73.9872329,"address":"252 W 46TH ST New York NY "},{"lat":40.7593831,"long":-73.9872329,"address":"252 W 46TH ST New York NY "},{"lat":40.7593831,"long":-73.9872329,"address":"252 W 46TH ST New York NY "},{"lat":40.7593831,"long":-73.9872329,"address":"252 W 46TH ST New York NY "},{"lat":40.7593831,"long":-73.9872329,"address":"252 W 46TH ST New York NY "},{"lat":40.7796494,"long":-73.982239,"address":"236 W 73RD ST New York NY "},{"lat":40.7381228,"long":-74.0010304,"address":"208 W 13TH ST New York, NY"},{"lat":40.7335702,"long":-74.0037456,"address":"83 CHRISTOPHER ST New York NY "},{"lat":40.7381228,"long":-74.0010304,"address":"208 W 13TH ST New York, NY"}],"num_obs":"7"},{"mtspin":"Gay Men","schedule":[{"day":"Saturday","time":"12:30 PM"},{"day":"Sunday","time":"6:00 PM"}],"location":[{"lat":40.8321452,"long":-73.9448547,"address":"550 W 155TH ST New York NY "},{"lat":40.729824,"long":-73.982816,"address":"411 E 12TH ST New York, NY"}],"num_obs":"2"},{"mtspin":"Interpreted for the Deaf","schedule":[{"day":"Sunday","time":"12:00 PM"}],"location":[{"lat":40.7381228,"long":-74.0010304,"address":"208 W 13TH ST New York, NY"}],"num_obs":"1"},{"mtspin":"Lesbian","schedule":[{"day":"Saturday","time":"6:00 PM"}],"location":[{"lat":40.7381228,"long":-74.0010304,"address":"208 W 13TH ST New York, NY"}],"num_obs":"1"},{"mtspin":"Living Sober","schedule":[{"day":"Saturday","time":"8:00 AM"},{"day":"Saturday","time":"1:30 PM"}],"location":[{"lat":40.7575385,"long":-73.9901368,"address":"303 W 42ND ST New York NY "},{"lat":40.7593831,"long":-73.9872329,"address":"252 W 46TH ST New York NY "}],"num_obs":"2"},{"mtspin":"Meditation","schedule":[{"day":"Sunday","time":"11:00 AM"},{"day":"Sunday","time":"12:30 PM"},{"day":"Saturday","time":"4:30 PM"},{"day":"Sunday","time":"5:00 PM"},{"day":"Sunday","time":"7:00 PM"},{"day":"Sunday","time":"9:00 AM"},{"day":"Saturday","time":"7:30 PM"}],"location":[{"lat":40.7208165,"long":-74.0048523,"address":"283 W BROADWAY New York NY "},{"lat":40.7286385,"long":-74.0045871,"address":"220 W HOUSTON ST New York NY "},{"lat":40.7575385,"long":-73.9901368,"address":"303 W 42ND ST New York NY "},{"lat":40.6639307188879,"long":-73.9382749875207,"address":"865 MADISON STATE ROAD NY AVE New York NY "},{"lat":40.7307719,"long":-73.9903164,"address":"61 FOURTH AVE New York, NY"},{"lat":40.7384244,"long":-73.9840055,"address":"155 E 22ND ST New York, NY"},{"lat":40.7483929,"long":-73.9787906,"address":"122 E 37TH ST New York, NY"}],"num_obs":"7"},{"mtspin":"Men","schedule":[{"day":"Sunday","time":"10:30 AM"},{"day":"Sunday","time":"2:00 PM"},{"day":"Saturday","time":"5:00 PM"},{"day":"Sunday","time":"5:00 PM"}],"location":[{"lat":40.7708644,"long":-73.9806413,"address":"5 W 63RD ST New York NY "},{"lat":40.7721222,"long":-73.9517608,"address":"413 E 79TH STATE ROAD NY ST New York NY "},{"lat":40.8232166,"long":-73.9484769,"address":"469 W 142ND ST New York NY "},{"lat":40.7345135,"long":-73.9854432,"address":"209 E 16TH ST New York, NY"}],"num_obs":"4"},{"mtspin":"Promises","schedule":[{"day":"Sunday","time":"8:00 PM"},{"day":"Saturday","time":"6:00 PM"},{"day":"Saturday","time":"6:30 PM"},{"day":"Saturday","time":"8:00 PM"},{"day":"Saturday","time":"7:00 PM"},{"day":"Sunday","time":"6:15 PM"}],"location":[{"lat":40.7721222,"long":-73.9517608,"address":"413 E 79TH STATE ROAD NY ST New York NY "},{"lat":40.74314,"long":-73.9781525,"address":"236 E 31ST ST New York, NY"},{"lat":40.7774259,"long":-73.9812051,"address":"152 W 71ST ST New York NY "},{"lat":40.729824,"long":-73.982816,"address":"411 E 12TH ST New York, NY"},{"lat":40.7599913,"long":-73.9948326,"address":"484 W 43RD ST New York NY "},{"lat":40.7483929,"long":-73.9787906,"address":"122 E 37TH ST New York, NY"}],"num_obs":"6"},{"mtspin":"Special Purpose Groups","schedule":[{"day":"Saturday","time":"9:30 PM"}],"location":[{"lat":40.7381228,"long":-74.0010304,"address":"208 W 13TH ST New York, NY"}],"num_obs":"1"},{"mtspin":"Sponsorship Workshop","schedule":[{"day":"Saturday","time":"1:15 PM"}],"location":[{"lat":40.729824,"long":-73.982816,"address":"411 E 12TH ST New York, NY"}],"num_obs":"1"},{"mtspin":"Steps 1-2-3","schedule":[{"day":"Saturday","time":"4:00 PM"}],"location":[{"lat":40.7721222,"long":-73.9517608,"address":"413 E 79TH STATE ROAD NY ST New York NY "}],"num_obs":"1"},{"mtspin":"Topic","schedule":[{"day":"Saturday","time":"7:30 AM"}],"location":[{"lat":40.7236736,"long":-73.9924832,"address":"273 BOWERY ST New York NY "}],"num_obs":"1"},{"mtspin":"Twelve Steps","schedule":[{"day":"Sunday","time":"6:15 PM"}],"location":[{"lat":40.7744405,"long":-73.9838262,"address":"152 W 66TH ST New York NY "}],"num_obs":"1"},{"mtspin":"Women","schedule":[{"day":"Saturday","time":"4:45 PM"},{"day":"Saturday","time":"1:00 PM"},{"day":"Saturday","time":"9:30 AM"},{"day":"Saturday","time":"9:00 AM"},{"day":"Sunday","time":"2:00 PM"},{"day":"Saturday","time":"2:00 PM"},{"day":"Saturday","time":"9:15 AM"},{"day":"Sunday","time":"3:00 PM"},{"day":"Saturday","time":"12:00 PM"}],"location":[{"lat":40.7286385,"long":-74.0045871,"address":"220 W HOUSTON ST New York NY "},{"lat":40.7276820090652,"long":-73.9857361176058,"address":"80 SAINT MARK New York, NY"},{"lat":40.7694194,"long":-73.9555151,"address":"351 E 74TH STATE ROAD NY ST New York NY "},{"lat":40.7992334,"long":-73.9710638,"address":"306 W 102ND ST New York NY "},{"lat":40.7575385,"long":-73.9901368,"address":"303 W 42ND ST New York NY "},{"lat":40.7721222,"long":-73.9517608,"address":"413 E 79TH STATE ROAD NY ST New York NY "},{"lat":40.7694194,"long":-73.9555151,"address":"351 E 74TH STATE ROAD NY ST New York NY "},{"lat":40.7483929,"long":-73.9787906,"address":"122 E 37TH ST New York, NY"},{"lat":40.7593831,"long":-73.9872329,"address":"252 W 46TH ST New York NY "}],"num_obs":"8"},{"mtspin":"Young People","schedule":[{"day":"Saturday","time":"7:00 PM"},{"day":"Saturday","time":"7:00 PM"}],"location":[{"lat":40.7844228,"long":-73.9716168,"address":"26 W 84TH ST New York NY "},{"lat":40.7208165,"long":-74.0048523,"address":"283 W BROADWAY New York NY "}],"num_obs":"2"}];

        var mymap = L.map('mapid').setView([40.734636,-73.994997], 11);

        L.tileLayer('https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.png?access_token={accessToken}', {
            attribution: 'Map data &copy; <a href="https://www.openstreetmap.org/">OpenStreetMap</a> contributors, <a href="https://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, Imagery Â© <a href="https://www.mapbox.com/">Mapbox</a>',
            minZoom: 11,
            maxZoom: 20,
            id: 'mapbox.light',
            // accessToken: 'your.mapbox.access.token'
            accessToken: 'pk.eyJ1IjoiZHZpYTIwMTciLCJhIjoiY2o5NmsxNXIxMDU3eTMxbnN4bW03M3RsZyJ9.VN5cq0zpf-oep1n1OjRSEA'
          }).addTo(mymap);

          var circles = [];
          for (var i=0; i<data.length; i++) {
                for (var j=0; j<data[i].location.length; j++){
                  // removeAllCircles();
                  if (data[i].schedule[j].day == "Sunday"){
                    var circle = L.circleMarker([data[i].location[j].lat, data[i].location[j].long], {
                        color: '#0B346E',      // #FFC408
                        radius: 5
                    });
                  } else {
                    var circle = L.circleMarker([data[i].location[j].lat, data[i].location[j].long], {
                        color: '#FFC408',
                        radius: 5
                    });
                  }
                  // circle.bindPopup(data[i].schedule[j].day+' '+data[i].schedule[j].time+'\n @ '+data[i].location[j].address)
                            circle.bindPopup("<dl><dt>Schedule</dt>"+"<dd>"+data[i].schedule[j].day+"\n"+data[i].schedule[j].time+"</dd>"+"<dt>Location</dt>"+"<dd>"+data[i].location[j].address+"</dd></dl>");
                  circle.addTo(mymap);
                  circles.push(circle);
                }

          }

          var meeting = {
            "Show All": true,
            "Special Interest": "Pick One"
          };

          var gui = new dat.gui.GUI();
          gui.add(meeting, 'Show All').onChange(function(check){
            if (check){
              removeAllCircles();
              for (var i=0; i<data.length; i++) {
                    for (var j=0; j<data[i].location.length; j++){
                      // removeAllCircles();
                      if (data[i].schedule[j].day == "Sunday"){
                        var circle = L.circleMarker([data[i].location[j].lat, data[i].location[j].long], {
                            color: '#0B346E',      // #FFC408
                            radius: 5
                        });
                      } else {
                        var circle = L.circleMarker([data[i].location[j].lat, data[i].location[j].long], {
                            color: '#FFC408',
                            radius: 5
                        });
                      }
                      circle.bindPopup(data[i].schedule[j].day+ ' '+data[i].schedule[j].time+'\n @ '+data[i].location[j].address)
                      circle.addTo(mymap);
                      circles.push(circle);
                    }
              }
            } else {
              removeAllCircles();
            }
          });

          gui.add(meeting, 'Special Interest', ["Agnostic","As Bill Sees It","Beginners Workshop","Big Book Workshop","Children Welcome","Eleventh Step","Eleventh Step Meditation","First Step Workshop","Fourth Step Workshop","Gay, Lesbian and Bisexual","Gay Men","Interpreted for the Deaf","Lesbian","Living Sober","Meditation","Men","Promises","Special Purpose Groups","Sponsorship Workshop","Steps 1-2-3","Topic","Twelve Steps","Women","Young People"]).onChange(function(spinterest){
            removeAllCircles();
            for (var i=0; i<data.length; i++) {
                if (data[i].mtspin == spinterest){
                  for (var j=0; j<data[i].location.length; j++){
                    if (data[i].schedule[j].day == "Sunday"){
                      var circle = L.circleMarker([data[i].location[j].lat, data[i].location[j].long], {
                          color: '#0B346E',      // #FFC408
                          radius: 5
                      });
                    } else {
                      var circle = L.circleMarker([data[i].location[j].lat, data[i].location[j].long], {
                          color: '#FFC408',
                          radius: 5
                      });
                    }
                    circle.bindPopup(data[i].schedule[j].day+' '+data[i].schedule[j].time+'\n @ '+data[i].location[j].address)
                    circle.addTo(mymap);
                    circles.push(circle);
                  }

                }
            }
          });


        function removeAllCircles(){
            // remove each circle from the map and empty our array of references
            circles.forEach(function(circle, i){
                mymap.removeLayer(circle);
            })
            circles = [];
        }

      </script>>
    </div>
  </body>
</html>
